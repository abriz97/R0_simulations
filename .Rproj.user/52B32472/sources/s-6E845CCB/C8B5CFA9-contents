data <- as.data.frame(data)

# define a fixed mean and SD of the generation time distribution, GT
mean_GT <- 20/7
sd_GT <- 7.4/7
variance_GT <- sd_GT^2
GTd <- R0::generation.time("gamma", c(mean_GT, sd_GT))

# define the moment generating function of the GT distribution, g(a)
Mz_ga <- function(t, r){
  dgamma(t, shape=(mean_GT^2/variance_GT), scale=(variance_GT/mean_GT))*exp(-t*r)
}



# dataframe to store results
results <- data.frame(Country=NA, Nweeks=NA, method=NA, R0=NA, CI_L=NA, CI_U=NA)

# define peak - max time point of highest reported cases
peak <- max.col(matrix(data$cases,nrow=1),"last") 


# if peak is >=6 weeks after 1st case report, run analysis
if(peak>=6){
  
  # define sections: from 6 weeks, by 3, up to peak (i.e. 6,9,12,15...)
  sections <- seq(from=6, to=peak, by=3)
  
  count <- 0
  
  # Loop to fit each method to each section with increasing number of time points
  for(j in 1:length(sections)){
    
    # extract section of the epidemic curve for fitting
    s <- data[1:sections[j], ]